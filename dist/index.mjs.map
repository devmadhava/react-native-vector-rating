{"version":3,"sources":["../src/Rating.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\r\nimport { Pressable, View } from \"react-native\";\r\n\r\nexport type RatingProps = {\r\n    value?: number;\r\n    defaultValue?: number;\r\n    icon?: any;\r\n    size?: number;\r\n    gap?: number;\r\n    count?: number;\r\n    color?: string;\r\n    emptyColor?: string;\r\n    disabled?: boolean;\r\n    onChange?: (value: number) => void;\r\n};\r\n\r\ntype StarSVGProps = {\r\n    size?: number;\r\n    color?: string;\r\n};\r\n\r\nconst StarSVG = ({ size = 50, color = \"gold\" }: StarSVGProps) => {\r\n    const starSize = size;\r\n    const half = starSize / 2;\r\n    const angles = [0, 72, 144, 216, 288];\r\n\r\n    return (\r\n        <View\r\n            style={{\r\n                width: size,\r\n                height: size,\r\n                justifyContent: \"center\",\r\n                alignItems: \"center\",\r\n            }}\r\n        >\r\n            {angles.map((angle, i) => (\r\n                <View\r\n                    key={i}\r\n                    style={{\r\n                        position: \"absolute\",\r\n                        width: 0,\r\n                        height: 0,\r\n                        borderLeftWidth: half / 2,\r\n                        borderRightWidth: half / 2,\r\n                        borderBottomWidth: half,\r\n                        borderLeftColor: \"transparent\",\r\n                        borderRightColor: \"transparent\",\r\n                        borderBottomColor: color,\r\n                        top: size / 2 - half,\r\n                        left: size / 2 - half / 2,\r\n                        transform: [{ rotate: `${angle}deg` }],\r\n                        transformOrigin: \"bottom\",\r\n                    }}\r\n                />\r\n            ))}\r\n        </View>\r\n    );\r\n};\r\n\r\nexport function Rating({\r\n    value,\r\n    defaultValue = 3.5,\r\n    icon: RatingIcon = <StarSVG />,\r\n    size = 20,\r\n    gap = 0,\r\n    count = 5,\r\n    color,\r\n    emptyColor = \"gray\",\r\n    disabled = false,\r\n    onChange,\r\n}: RatingProps) {\r\n    const isControlled = value !== undefined;\r\n    const [internalValue, setInternalValue] = useState(defaultValue);\r\n    const rating = isControlled ? value! : internalValue;\r\n\r\n    // Calculating Margin only once and key too - the props for all icons\r\n    const stars = useMemo(\r\n        () =>\r\n            [...Array(count)].map((_, i) => ({\r\n                // i: i,\r\n                marginRight: i === count - 1 ? 0 : gap,\r\n            })),\r\n        [count, gap]\r\n    );\r\n\r\n    // Calculating Width\r\n    const totalWidth = size * count + gap * (count - 1);\r\n    const activeWidth = size * rating + gap * Math.floor(rating);\r\n\r\n    // Handle Press\r\n    const handlePress = (i: number) => {\r\n        if (disabled) return;\r\n\r\n        const newRating = i + 1;\r\n        if (!isControlled) {\r\n            setInternalValue(newRating);\r\n        }\r\n\r\n        if (onChange) {\r\n            onChange(newRating);\r\n        }\r\n    };\r\n\r\n    // Type Check Solution\r\n    // const baseProps = (RatingIcon.props ?? {}) as Record<string, any>;\r\n    const baseProps = useMemo(\r\n        () => (RatingIcon.props ?? {}) as Record<string, any>,\r\n        [RatingIcon]\r\n    );\r\n\r\n    // Clone icon with new color + size\r\n    const EmptyIconMemo = useMemo(() => {\r\n        return React.cloneElement(RatingIcon, {\r\n            ...baseProps,\r\n            size,\r\n            width: size,\r\n            height: size,\r\n            color: emptyColor,\r\n            fill: emptyColor,\r\n            stroke: emptyColor,\r\n        });\r\n    }, [size, emptyColor, RatingIcon]);\r\n\r\n    // Active icon with color if given else uses provided color\r\n    // const ActiveIconMemo = useMemo(() => {\r\n    //     const useUserColor = color == null;\r\n\r\n    //     return React.cloneElement(RatingIcon, {\r\n    //         ...baseProps,\r\n    //         size,\r\n    //         width: size,\r\n    //         height: size,\r\n\r\n    //         ...(useUserColor\r\n    //             ? {\r\n    //                   color: baseProps.color,\r\n    //                   fill: baseProps.fill,\r\n    //                   stroke: baseProps.stroke,\r\n    //               }\r\n    //             : {\r\n    //                   color,\r\n    //                   fill: color,\r\n    //                   stroke: color,\r\n    //               }),\r\n    //     });\r\n    // }, [size, color, RatingIcon]);\r\n    const ActiveIconMemo = useMemo(() => {\r\n        // If Rating.color is given, override icon color\r\n        if (color != null) {\r\n            return React.cloneElement(RatingIcon, {\r\n                ...baseProps,\r\n                size,\r\n                width: size,\r\n                height: size,\r\n\r\n                color,\r\n                fill: color,\r\n                stroke: color,\r\n            });\r\n        }\r\n\r\n        // ELSE: use icon exactly as user defined it\r\n        return React.cloneElement(RatingIcon, {\r\n            ...baseProps,\r\n            size,\r\n            width: size,\r\n            height: size,\r\n        });\r\n    }, [size, color, RatingIcon]);\r\n\r\n    return (\r\n        // Container\r\n        <View style={{ width: totalWidth, height: size }}>\r\n            {/* Gray Icons */}\r\n            <View style={{ flexDirection: \"row\" }}>\r\n                {stars.map(({ marginRight }, i) => (\r\n                    <View key={i} style={{ marginRight }}>\r\n                        {EmptyIconMemo}\r\n                    </View>\r\n                ))}\r\n            </View>\r\n\r\n            {/* Active Icons */}\r\n            <View\r\n                style={{\r\n                    position: \"absolute\",\r\n                    top: 0,\r\n                    left: 0,\r\n                    overflow: \"hidden\",\r\n                    width: activeWidth,\r\n                    height: size,\r\n                }}\r\n            >\r\n                <View style={{ flexDirection: \"row\" }}>\r\n                    {stars.map(({ marginRight }, i) => (\r\n                        <View key={i} style={{ marginRight }}>\r\n                            {ActiveIconMemo}\r\n                        </View>\r\n                    ))}\r\n                </View>\r\n            </View>\r\n\r\n            {/* Pressable Area - More stable than pointer events none and using pressable in gray icon :( */}\r\n            <View\r\n                style={{\r\n                    position: \"absolute\",\r\n                    height: size,\r\n                    flexDirection: \"row\",\r\n                }}\r\n            >\r\n                {stars.map(({ marginRight }, i) => (\r\n                    <Pressable\r\n                        key={i}\r\n                        onPress={() => handlePress(i)}\r\n                        style={{ width: size, height: size, marginRight }}\r\n                    />\r\n                ))}\r\n            </View>\r\n        </View>\r\n    );\r\n}\r\n"],"mappings":"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","names":[]}